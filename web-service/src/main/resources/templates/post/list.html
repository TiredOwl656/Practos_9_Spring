<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Все посты - Социальная сеть</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
        <a class="navbar-brand" th:href="@{/}">Social Network</a>
        <div class="navbar-nav ms-auto">
            <a class="nav-link" th:href="@{/}">Главная</a>
            <a class="nav-link" th:href="@{/posts}">Посты</a>
            <a class="nav-link" th:href="@{/users}">Пользователи</a>
            <th:block th:if="${session.currentUser != null}">
                <a class="nav-link" th:href="@{/feed}">Моя лента</a>
                <a class="nav-link" th:href="@{/posts/create}">Создать пост</a>
                <a class="nav-link" th:href="@{/users/profile}">Мой профиль</a>
                <span class="navbar-text mx-2" th:text="${session.currentUser.username}">User</span>
                <form th:action="@{/logout}" method="post" class="d-inline">
                    <button type="submit" class="btn btn-outline-light btn-sm">Выйти</button>
                </form>
            </th:block>
            <th:block th:unless="${session.currentUser != null}">
                <a class="nav-link" th:href="@{/login}">Войти</a>
                <a class="nav-link" th:href="@{/register}">Регистрация</a>
            </th:block>
        </div>
    </div>
</nav>

<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>Все посты</h2>
        <div th:if="${session.currentUser != null}">
            <a th:href="@{/posts/create}" class="btn btn-primary">Создать пост</a>
        </div>
    </div>

    <div th:if="${posts != null and !posts.isEmpty()}">
        <div th:each="post : ${posts}" class="card mb-4">
            <div class="card-body">
                <h5 class="card-title" th:text="${post.title}">Заголовок поста</h5>
                <p class="card-text" th:text="${post.content}">Содержание поста...</p>

                <div class="d-flex justify-content-between align-items-center">
                    <small class="text-muted">
                        Автор:
                        <a th:href="@{'/users/' + ${post.authorId}}"
                           th:text="${post.authorUsername}">username</a>
                    </small>
                    <div>
                        <span class="badge bg-primary me-2" th:text="${post.likesCount} + ' ❤️'">0 ❤️</span>
                    </div>
                </div>

                <div class="mt-3">
                    <a th:href="@{'/posts/' + ${post.id}}" class="btn btn-sm btn-outline-primary me-2">
                        Читать полностью
                    </a>
                    <div th:if="${session.currentUser != null}" class="d-inline">
                        <form th:action="@{'/posts/' + ${post.id} + '/like'}" method="post" class="d-inline">
                            <button type="submit" class="btn btn-sm btn-outline-danger">❤️ Лайк</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div th:if="${posts == null or posts.isEmpty()}" class="text-center py-5">
        <h4 class="text-muted">Посты не найдены</h4>
        <p class="text-muted">Будьте первым, кто опубликует пост!</p>
        <a th:href="@{/posts/create}" class="btn btn-primary">Создать первый пост</a>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>